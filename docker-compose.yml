services:
  docmostsaurus:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: docmostsaurus
    restart: unless-stopped
    environment:
      # Docmost configuration
      - DOCMOST_BASE_URL=${DOCMOST_BASE_URL:-http://docmost:3000}
      - DOCMOST_EMAIL=${DOCMOST_EMAIL}
      - DOCMOST_PASSWORD=${DOCMOST_PASSWORD}
      # Sync settings
      - SYNC_INTERVAL=${SYNC_INTERVAL:-1h}
      - OUTPUT_DIR=/app/output
      # Health check port 
      - HTTP_PORT=:8080
      # Note: Lock file uses /tmp/docmostsaurus.lock (hardcoded)
    volumes:
      - ./output:/app/output
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    stop_grace_period: 60s
