services:
  doc2git:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: doc2git
    restart: unless-stopped
    environment:
      # Docmost configuration
      - DOCMOST_BASE_URL=${DOCMOST_BASE_URL:-http://docmost:3000}
      - DOCMOST_API_TOKEN=${DOCMOST_API_TOKEN}
      # Sync settings
      - SYNC_INTERVAL=${SYNC_INTERVAL:-1h}
      - OUTPUT_DIR=/app/output
      # Git settings
      - GIT_REPO_PATH=/app/repo
      - GIT_BRANCH=${GIT_BRANCH:-main}
      - AUTO_PUSH=${AUTO_PUSH:-false}
      # Git Remote (optional)
      - GIT_REMOTE_URL=${GIT_REMOTE_URL:-}
      - GIT_USERNAME=${GIT_USERNAME:-}
      - GIT_PASSWORD=${GIT_PASSWORD:-}
    volumes:
      # Persist output and git repository
      - ./output:/app/output
      - ./repo:/app/repo
    networks:
      - docmost_default

networks:
  docmost_default:
    external: true
